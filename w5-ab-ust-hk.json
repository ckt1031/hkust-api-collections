{
  "openapi": "3.0.0",
  "info": {
    "title": "HKUST Library Booking API",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://w5.ab.ust.hk/msapi"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/token/request": {
      "post": {
        "summary": "Request a temporary access token",
        "tags": [
          "Authentication"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "access_token": {
                          "type": "string",
                          "description": "Temporary access token"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/getInfo": {
      "get": {
        "summary": "Get library information",
        "tags": [
          "Library"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "type": "string",
                          "example": "LIBRARY"
                        },
                        "areas": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "8"
                              },
                              "area_name": {
                                "type": "string",
                                "example": "LC Study Rooms"
                              },
                              "open_time": {
                                "type": "string",
                                "example": "00:00"
                              },
                              "close_time": {
                                "type": "string",
                                "example": "00:00"
                              },
                              "area_sort_order": {
                                "type": "integer",
                                "example": 2
                              },
                              "calendar_link": {
                                "type": "string",
                                "example": "https://lbbooking.hkust.edu.hk/calendar/week.php?area=8"
                              },
                              "rooms": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "id": {
                                      "type": "string",
                                      "example": "57"
                                    },
                                    "room_name": {
                                      "type": "string",
                                      "example": "LC-01"
                                    },
                                    "capacity": {
                                      "type": "string",
                                      "example": "7"
                                    },
                                    "custom_html": {
                                      "type": "string",
                                      "example": "http://library.ust.hk/map/lc-01"
                                    },
                                    "room_sort_order": {
                                      "type": "integer",
                                      "example": 19
                                    },
                                    "bookable_class": {
                                      "type": "string",
                                      "example": "|POSTGRADUATE|RESEARCH POSTGRADUATE|TAUGHT POSTGRADUATE|UNDERGRADUATE|"
                                    },
                                    "calendar_link": {
                                      "type": "string",
                                      "example": "https://lbbooking.hkust.edu.hk/calendar/week.php?room=57"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/getMySchedule": {
      "get": {
        "summary": "Get my booked rooms",
        "tags": [
          "Booking"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "token",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Temporary access token"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "numEntry": {
                          "type": "integer",
                          "example": 1
                        },
                        "bookings": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "0000000"
                              },
                              "name": {
                                "type": "string",
                                "example": "CHAN Tai Man"
                              },
                              "room_id": {
                                "type": "string",
                                "example": "76"
                              },
                              "start_time": {
                                "type": "integer",
                                "format": "int64",
                                "description": "Unix timestamp",
                                "example": 1672531200
                              },
                              "end_time": {
                                "type": "integer",
                                "format": "int64",
                                "description": "Unix timestamp",
                                "example": 1672549200
                              },
                              "type": {
                                "type": "string",
                                "example": "U"
                              },
                              "create_by": {
                                "type": "string",
                                "example": "yourmum"
                              },
                              "description": {
                                "type": "string",
                                "nullable": true
                              },
                              "ical_uid": {
                                "type": "string",
                                "example": "yourmum@lbbooking.hkust.edu.hk"
                              },
                              "userclass": {
                                "type": "string",
                                "example": "UNDERGRADUATE"
                              },
                              "start_time_YYYYMMDD": {
                                "type": "string",
                                "example": "20240101"
                              },
                              "start_time_hhmm": {
                                "type": "string",
                                "example": "0000"
                              },
                              "end_time_YYYYMMDD": {
                                "type": "string",
                                "example": "20240101"
                              },
                              "end_time_hhmm": {
                                "type": "string",
                                "example": "2300"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/getSessionsByDay": {
      "get": {
        "summary": "Get room sessions for a day",
        "tags": [
          "Booking"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "area",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Area ID"
          },
          {
            "in": "query",
            "name": "year",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "month",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "day",
            "schema": {
              "type": "integer"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "rooms": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "11"
                              },
                              "room_name": {
                                "type": "string",
                                "example": "1-352"
                              },
                              "capacity": {
                                "type": "string",
                                "example": "8"
                              },
                              "custom_html": {
                                "type": "string",
                                "example": "http://library.ust.hk/map/1352"
                              },
                              "booking_link": {
                                "type": "string",
                                "example": "https://lbbooking.hkust.edu.hk/calendar/week.php?year=2024&month=10&day=31&room=11&area=3"
                              },
                              "calendar_link": {
                                "type": "string",
                                "example": "https://lbbooking.hkust.edu.hk/calendar/week.php?year=2024&month=10&day=31&room=11&area=3"
                              },
                              "start_date": {
                                "type": "string",
                                "example": "20241031"
                              },
                              "end_date": {
                                "type": "string",
                                "example": "20241031"
                              },
                              "sessions": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "start_time": {
                                      "type": "integer",
                                      "format": "int64",
                                      "description": "Unix timestamp",
                                      "example": 1730304000
                                    },
                                    "start_time_YYYYMMDD": {
                                      "type": "string",
                                      "example": "20241031"
                                    },
                                    "start_time_hhmm": {
                                      "type": "string",
                                      "example": "00:00"
                                    },
                                    "end_time": {
                                      "type": "integer",
                                      "format": "int64",
                                      "description": "Unix timestamp",
                                      "example": 1730332800
                                    },
                                    "end_time_YYYYMMDD": {
                                      "type": "string",
                                      "example": "20241031"
                                    },
                                    "end_time_hhmm": {
                                      "type": "string",
                                      "example": "08:00"
                                    },
                                    "status": {
                                      "type": "string",
                                      "example": "closed"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/entry": {
      "delete": {
        "summary": "Cancel a booking",
        "tags": [
          "Booking"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Booking ID"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Book a room",
        "tags": [
          "Booking"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "area",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Area ID"
          },
          {
            "in": "query",
            "name": "room",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Room ID"
          },
          {
            "in": "query",
            "name": "year",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "month",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "day",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "hour",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "min",
            "schema": {
              "type": "integer"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "duration",
            "schema": {
              "type": "integer"
            },
            "required": true,
            "description": "Duration in minutes"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "0000000"
                        },
                        "ical_uid": {
                          "type": "string",
                          "example": "yourmum@lbbooking.hkust.edu.hk"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}